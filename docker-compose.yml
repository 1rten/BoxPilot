services:
  boxpilot:
    build: .
    image: boxpilot:latest
    container_name: boxpilot
    ports:
      - "${BIND_IP:-0.0.0.0}:8080:8080"
      - "${BIND_IP:-0.0.0.0}:7890:7890"
      - "${BIND_IP:-0.0.0.0}:7891:7891"
    environment:
      - DATA_DIR=/data
      - DB_PATH=/data/app.db
      - SINGBOX_CONFIG=/data/sing-box.json
      - SINGBOX_RESTART_CMD=/app/docker/restart-singbox.sh
      - HTTP_PROXY_PORT=7890
      - SOCKS_PROXY_PORT=7891
      - BACKUP_KEEP=10
    volumes:
      - ./data:/data
